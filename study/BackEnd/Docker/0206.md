# Apache Kafka
**ëŒ€ëŸ‰ì˜ ë°ì´í„°**ë¥¼ **ì‹¤ì‹œê°„ìœ¼ë¡œ** ì•ˆì „í•˜ê²Œ ì „ë‹¬Â·ì €ì¥í•˜ëŠ” ì¤‘ê°„ í—ˆë¸Œ
ë©”ì„¸ì§•í”„ë¡œê·¸ë¨(ê³µìœ í•´ì•¼í•˜ëŠ” ë°ì´í„° ì‹±í¬, ì´ë©”ì¼, ì•Œë¦¼ì„¤ì • ë“±ë“± ì‹¤í–‰ê°€ëŠ¥)  

## ğŸ¤” ì™œ ì¹´í”„ì¹´ë¥¼ ì“°ë‚˜ìš”?
producer A -> cunsumer A  
producer A -> cunsumer b  
producer A -> cunsumer c   
ì´ëŸ° ì‹œìŠ¤í…œì¼ ê²½ìš° producer Aê°€ í„°ì§€ë©´ ëª¨ë“  ì»¨ìŠˆë¨¸ê°€ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ì—†ê²Œ ë¨  
ì„œë¹„ìŠ¤ A â†’ Kafka â†’ B  
                â†’ C  
                â†’ D  
AëŠ” ì±…ì„ ì§ˆê²Œ ì—†ì–´ì§  



## íë¦„ë„
![alt text](image-2.png)
producerê°€ brokerì— ë©”ì„¸ì§€ ì „ë‹¬
ì´ Brokerê°€ kafka, pd&csê°€ ê°œë°œìê°€ ë§Œë“  ê²ƒë“¤
ì»¨ìŠˆë¨¸ê°€ ë©”ì„¸ì§€ í•˜ë‚˜ë¥¼ ì½ìŒ -> ì²˜ë¦¬ ì™„ë£Œë˜ë©´ ë¸Œë¡œì»¤ê°€ ì‚­ì œí•¨

## CMDì—ì„œ kafka ì‹¤í–‰í•˜ê¸°
kafka ëª…ë ¹ì–´ëŠ” windowì—ì„œ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ì—†ìŒ
-> í™˜ê²½ë³€ìˆ˜ ì„¤ì •
-> ì‹œìŠ¤í…œ ë³€ìˆ˜ì˜ Path 
-> í¸ì§‘ ëˆŒëŸ¬ì„œ ìƒˆë¡œ ë§Œë“¤ê¸°
-> ë‚´ê°€ kafka Binary ë‹¤ìš´ë¡œë“œí•œ ê²½ë¡œ ê·¸ëŒ€ë¡œ ë³µë¶™í•´ì„œ ìƒì„±
-> cmdì— ë“¤ì–´ê°€ì„œ kafka ëª…ë ¹ì–´ ì‹¤í–‰í•˜ë©´ ì‹¤í–‰ ë¨!

1. Kafka ì´ë¯¸ì§€ ë°›ê¸°
```
docker pull apache/kafka:4.0.1
```

2. docker container ì ‘ì†í•˜ê¸°
```
docker exec -it kafka /bin/bash
```

3. kafka íŒŒì¼ ìœ„ì¹˜ë¡œ ì ‘ê·¼í•˜ê¸°
```
cd /opt/kafka/bin
```

4. í† í”½ ë§Œë“¤ê¸°
```
./kafka-topics.sh --bootstrap-server localhost:9092 --create --topic my-topic
```

5. í† í”½ ëª©ë¡ ë³´ê¸°
```
./kafka-topics.sh --bootstrap-server localhost:9092 --list
```

6. í† í”½ ëª©ë¡ ì‚­ì œí•˜ê¸°
```
./kafka-topics.sh --bootstrap-server localhost:9092 --delete --topic my-topic
```

7. í† í”½ì— ë‚´ìš©ë¬¼ ë„£ê¸°
```
./kafka-console-producer.sh --bootstrap-server localhost:9092 --topic test
```
- producerë¡œ ë“¤ì–´ê°€ë©´ ë³´ë‚´ì§
```
./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning
```
- consumerë¡œ ë“¤ì–´ê°€ë©´ ë³´ë‚¸ ë‚´ìš© ë°›ì„ ìˆ˜ ìˆê³  ë’¤ì— --from-beginningì´ ìˆìœ¼ë©´ ì²« ë‚´ìš©ë¶€í„°, ì—†ìœ¼ë©´ ì ‘ì† ì‹œì ë¶€í„° ë³´ì—¬ì§


## pythonì—ì„œ kafka ì‹¤í–‰í•˜ê¸°
```main.py
from kafka import KafkaProducer

pd = KafkaProducer(bootstrap_servers="localhost:9092")

pd.send('test',b'loveyou')
#('í† í”½ì´ë¦„', b'ë©”ì„¸ì§€')
# producer&consumerì˜ í† í”½ ì´ë¦„ì´ ê°™ì•„ì•¼ í™•ì¸ì´ ê°€ëŠ¥í•¨
pd.flush()
# ë³´ë‚¸ë‹¤ëŠ” í•¨ìˆ˜
```
```ë°›ì„ìª½.py
from kafka import KafkaConsumer

cs=KafkaConsumer('test',bootstrap_servers=["localhost:9092"])

for msg in cs:
    print(msg.value)
```

ê·¸ë¦¬ê³  ê°ê° í„°ë¯¸ë„ ì—´ì–´ ê° íŒŒì¼ ì‹¤í–‰í•´ì£¼ê¸° => main.pyì˜ ë©”ì„¸ì§€ ë°”ê¿”ì„œ ì‹¤í–‰í•  ë•Œ ë§ˆë‹¤ consumer í„°ë¯¸ë„ì— ë‚´ìš©ì´ ì°í˜

[Kafka Tutorial PDF](./Kafka%20Python%20Tutorial.pdf)


## Fastapië¡œ Mailì„œë²„ ì‹¤í–‰í•˜ê¸°

[fastapi Mailì‚¬ì´íŠ¸](https://sabuhish.github.io/fastapi-mail/example/)